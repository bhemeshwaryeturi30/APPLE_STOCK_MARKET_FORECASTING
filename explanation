Got it ‚úÖ
You want the attributes extracted only for the columns actually used in SQL code 1 & SQL code 2 ‚Äî in the same documentation format I provided earlier.

Here is your complete extract:

‚∏ª

‚úÖ Metadata Documentation ‚Äî Teradata Source CF Master Queries

(SQL Code 1 & SQL Code 2 combined)

‚∏ª

üìå Base Table(s)

Database	Schema	Table	Attributes Used	Purpose
RXCOE_SA	(default)	SG_CF_MASTER (alias: t0)	PRSCRT_FILL_ID, CF_STORE_NBR, ST_CD, PROD_FISCAL_WEEK_NBR, LAST_PV2_DT, LAST_CF_SHIPPED_DT, LAST_CF_CHECKIN_DT, POS_TRNCT_DT, SALE_END_IND, DELIVERED_DATE, NEW_PRM_DT, HANDOFF_DATE, CENTR_FILL_STUS_IND, LAST_CF_CHG_EXP_DATE_DT, LAST_CF_ENT_QI_DT	Main Central Fill status + timestamps for KPI logic


‚∏ª

üìå Calendar Dimension Used

Database	Schema	Table	Attributes Used
IDW_COMMON	SEM_DIM_ALL_FISCAL_CAL_WEEK	SEM_DIM_ALL_FISCAL_CAL_WEEK (alias: t1)	FISCAL_WEEK_NBR, FISCAL_YEAR_NBR, FISCAL_MONTH_NBR, FISCAL_MONTH_END_DT, FISCAL_WEEK_START_DT, FISCAL_WEEK_END_DT, FISCAL_YEAR_START_DT


‚∏ª

üìå Output Columns / Metrics Used in KPI logic

Output Column Name	Definition
FILLS_PRODUCED	Distinct fills recorded in CF Master
FILLS_PV2	Fill events submitted to PV2
FILLS_SHIPPED	Fill events that were shipped from CF
FILLS_CHECKEDIN	Fill events checked in at store
FILLS_SOLD_ACT	Fill sold and recorded in POS
FILLS_SOLD	Fill sold with sale_end_ind = 1
CUST_SLA_NUM	Delivered ‚â§ Promise Date
CUST_SLA_DEN	Both Delivered Date + Promise Date exist
CUST_SLA_DEN_V2	Delivered OR Handoff, Promise date passed
SAME_DAY_CHECKIN_NUM	Delivered date = Check-in date
SAME_DAY_CHECKIN_DEN	Both delivered + check-in timestamps exist
SAME_DAY_CHECKIN_DEN_V2	Delivered exists (final denominator)

‚úîÔ∏è Includes all fields referenced in SUM()/COUNT()/CASE expressions

‚∏ª

üìå Filtering Rules

(Exact as used in SQL)

Category	Condition
CF Indicator	CENTR_FILL_STUS_IND='Y' or CF milestone timestamps captured
Date Filters	Fiscal Calendar Start ‚â• ‚Äò2024-01-01‚Äô (Code 1) / ‚Äò2023-01-01‚Äô (Code 2)
Range Window	LAST_CF_SHIPPED_DT between Fiscal Week boundaries
Currency	FISCAL_YEAR_START_DT < CURRENT_DATE
No future weeks	FISCAL_WEEK_END_DT < CURRENT_DATE
Facility Validation	t0.CF_STORE_NBR IS NOT NULL (SQL Code 1 only)


‚∏ª

‚úÖ Full Required Output Fields (Calendar + Store Dim)

Referenced from t1 + t0

Category	Columns
Calendar Dimensions	FISCAL_WEEK_NBR, FISCAL_YEAR_NBR, FISCAL_MONTH_NBR, PROD_FISCAL_WEEK_NBR, FISCAL_MONTH_END_DT, FISCAL_WEEK_START_DT, FISCAL_WEEK_END_DT
Location Dimensions	CF_STORE_NBR, ST_CD


‚∏ª

‚úÖ Final Deliverable (Copy-Ready Into Alation/Tableau Spec)

Source System: Teradata IDW  
Primary Fact Table: RXCOE_SA.SG_CF_MASTER  
Calendar Join: IDW_COMMON.SEM_DIM_ALL_FISCAL_CAL_WEEK  
Level of Grain: CF Store + Fiscal Week + Prescription Fill
Filters: Active CF timestamps only, no future fiscal weeks


‚∏ª

Optional ‚Äî I can now deliver one of the following additions:

AÔ∏è‚É£ KPI Formulas + numerator/denominator mapping table
BÔ∏è‚É£ ERD/Data Lineage diagram
CÔ∏è‚É£ Test plan SQL (validation between SQL Code 1 vs 2)
DÔ∏è‚É£ Migration mapping to Snowflake version
EÔ∏è‚É£ Alation Data Dictionary import file (CSV)

‚∏ª

Which one do you want next?

Just reply:

A or B or C or D or E
(or ALL) ‚úÖ
