Perfect — I’ve extracted the metadata from this entire script in the exact same structured format that we established ✅

⸻

✅ Extracted Metadata (Only Persistent Objects — No TEMP Tables)

Database	Schema	Base Table Name	Attributes Needed
DL_RX_OPERATION	RX_OPS_SANDBOX	AETNA_IL_BIN_BCN_GROUP	BIN, PCN, GRP
CORE_RX	CURATED_NCPDP	FACT_NCPDP_ACV_TXN	ACV_TXN_SEQ_NBR, SPLIT_BILL_CD, STORE_NBR, RX_NBR, RX_FILL_NBR, RQST_INS_RSPMBR_ID, CLM_DT_TME, CONDR_PLAN_NBR, CONDR_PLAN_EFF_DT, BIN_NBR, PROSCR_CONT_NBR, RQST_SVC_PROV_QUAL_ID, SRC_PAT_KEY_ID (AS RXC_PATIENT_ID), TXN_RSP_STAT_CD
CORE_RX	CURATED_PRODUCT	CONDOR_PLAN	CONDOR_PLAN_NBR, CONDOR_PLAN_NM, AGENCY_TYPE_DSC
CORE_FSSC	CURATED_OMS	YFS_ORDER_HEADER	ORDER_HEADER_KEY, ORDER_NO, ENTERPRISE_KEY, ORDER_DATE, SHIP_NODE, SHIP_TO_KEY, CUSTOMER_REWARDS_NO, EXTN_PRIMARY_COURIER, CREATEUSERID, MODIFYUSERID, DOCUMENT_TYPE, ORDER_TYPE, ENTRY_TYPE
CORE_FSSC	CURATED_OMS	YFS_ORDER_RELEASE_STATUS	ORDER_HEADER_KEY, STATUS_QUANTITY, STATUS
CORE_FSSC	CURATED_OMS	YFS_ORDER_LINE	ORDER_HEADER_KEY, EXTN_BASE_SHIPPING_CHARGE, LINE_TOTAL, INVOICED_LINE_TOTAL, INVOICED_EXTENDED_PRICE, SETTLED_AMOUNT, TAX
PROD_COMM_DB	CDP_APP	XTRA_CARD	ENCODED_XTRA_CARD_NBR
CORE_FSSC	CURATED_ORDERS	ORDER_DELIVERY	ORDER_ID, STORE_NBR, CANCEL_REASON_DSC, COURIER_NM, DELIVERY_SLA_CD, COLLEGUE_SLA_TS, DELIVERY_FEE_OVERRIDE_REASON_CD, DELIVERY_FEE_OVERRIDE_TS, DELIVERY_FEE_OVERRIDE_USER_NM, SHIPMENT_ORDER_NBR, REC_EFF_TS, TRANSACTION_NBR
CORE_FSSC	CURATED_ORDERS	ORDER_DELIVERY_ITEM	ORDER_ID, STORE_NBR, RX_NBR, FILL_NBR
CORE_FSSC	CURATED_ORDERS	ORDER_DELIVERY_HISTORY	ORDER_ID, STORE_NBR, ORDER_STATUS_CD, REC_EFF_TS
CORE_RX	CURATED_LOCATION	STORE	STORE_NBR, STATE_CD, CITY_NM
CORE_RX	CURATED_SCRIPT	PRESCRIPTION_FILL	RX_NBR, STORE_NBR, FILL_NBR, RXC_PATIENT_ID, TP_PLAN_NBR, NDC
PROD_COMM_DB	CDP_APP	CAREPASS_ENROLLMENT_HISTORY	XTRA_CARD_NBR, CREATE_DT, MEM_ENROLL_DT, MEMBERSHIP_STATUS, ENROLLMENT_ID, PRG_NAME
PROD_COMM_DB	CDP_APP	CAREPASS_ENROLLMENT	ENROLLMENT_ID, EMAIL_TXT, FIRST_NAME, LAST_NAME, PROFILE_ID, CONTRACT_ID
CORE_RX	CURATED_PATIENT	PATIENT	RXC_PATIENT_ID, FIRST_NM, LAST_NM, BIRTH_DT, MEMBER_ID


⸻

✅ All attributes are pulled only if explicitly used in SELECT, JOIN, WHERE, QUALIFY, CASE logic
✅ No fields included from TEMP tables
✅ No repeated data
✅ Format matches the very first requirement

⸻

✅ Quick Confirmation

Should I continue maintaining:

B — Separate metadata extraction by environment
Snowflake ✅
IDW (Teradata) ✅
RXCOE_PMI ✅

or merge everything into:

A — One combined master lineage table

You can reply with:

A → Merge all into one master metadata sheet
B → Keep per-script / per-environment structure
C → Build CSV exports for each environment

⸻

Would you like me to now extract the metadata for the final result sets (Sheet 1 & Sheet 2) as well?
