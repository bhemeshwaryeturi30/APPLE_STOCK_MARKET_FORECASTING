
Here’s your clean, professional README.md — written in the same structured format and tone as your previous Telepharmacy and Aetna SQL projects, following the original template you provided earlier:

⸻

Automation Script Volume & Recommended NDC Analysis

This repository contains the Snowflake SQL scripts used to calculate automation script volumes and identify recommended NDCs (National Drug Codes) for pharmacy automation systems. The analysis supports operational optimization by helping identify which drug products are suitable for automation, understanding unit-of-use (UOU) efficiency, and evaluating automation cell utilization across retail pharmacy stores.

⸻

Overview

The project consists of two main SQL workflows — AutomationScriptVolume.sql and Recommended NDC Lists.sql — that together measure automation utilization and generate optimized recommendations for pharmacy automation systems such as SP100, SP200, CRS, and Parata Max.

The first workflow computes automation fill volume and total prescription counts by store and fiscal week. The second identifies high-value NDCs for automation replenishment, ranking them based on average weekly script counts, unit-of-use ratios, and automation fill percentages. These analyses help determine whether stores are using automation efficiently and which medications are best suited for automated dispensing.

⸻

Setup and Variables

Before execution, connect to the Snowflake environment and ensure the correct database and schema are selected.
All queries use data from curated Snowflake layers such as:
	•	CORE_RX.CURATED_SCRIPT.PRESCRIPTION_FILL
	•	CORE_RX.CURATED_LOCATION.STORE
	•	CORE_FSSC.CURATED_CALENDAR.DAY
	•	CORE_RX.CURATED_PRODUCT.DRUG
	•	DL_RX_OPERATION.RX_OPS_SANDBOX.AUTOMATION_OPT_SCRIPT_DATA

No external parameters are required, but filters are based on fiscal periods (e.g., FISCAL_MONTH_NBR >= 202501) and recent fill activity (e.g., data from the past 30 days).

⸻

Core Tables and Queries

1. AutomationScriptVolume.sql

This script aggregates prescription fill activity by store and fiscal week to assess automation utilization.

Key logic includes:
	•	Counts total fills and automated fills (ACC_SCAN_STATUS_CD = '5').
	•	Evaluates unit-of-use (UOU) efficiency by checking if dispense quantity is a multiple of package size.
	•	Filters active automated stores (AUTOMATION_DETAIL_CD IS NOT NULL) and valid prescription statuses (FILL_STATUS_CD IN ('6','7','9')).
	•	Groups results by division, region, district, state, automation type, and week.

Main metrics:
	•	AUTOFILLS: Number of prescriptions filled via automation.
	•	TotalFills: Total number of prescriptions filled.
	•	CurrentUOU: Number of fills aligned with packaging unit standards.

This provides a weekly measure of automation volume and efficiency for each store.

⸻

2. Recommended NDC Lists.sql

This workflow identifies and ranks recommended NDCs for inclusion in automated dispensing systems.

Process Overview:
	1.	WEEKLY_NUMS CTE
Aggregates weekly prescription counts, unit-of-use compliance, and automation fills from the AUTOMATION_OPT_SCRIPT_DATA table.
Filters for:
	•	Preferred and non-excluded NDCs (PREFERRED_IND = 1, EXCLUSION_IND = 0)
	•	Active automation stores (AUTOMATION_REMOVAL_DT IS NULL)
	•	Non-controlled, schedulable medications (SCHEDULE_IND = 0)
	2.	RANKED CTE
Calculates average weekly metrics:
	•	AVG_SPW: Average scripts per week.
	•	AVG_UOU_RT: Average unit-of-use ratio.
	•	WEEKLY_AVG_AUTO_FILL_CNT: Average automated fill count.
Filters for products with less than 67% unit-of-use efficiency (AVG_UOU_RT < 0.67) and ranks each NDC within its store and automation type.
	3.	Current_NDC_in_auto CTE
Identifies NDCs currently being filled via automation in the past 30 days.
	4.	Final Output
Joins ranked recommendations with current automation NDCs to determine:
	•	Whether the NDC is already automated (Drug_in_auto = 'Y' or 'N').
	•	Appropriate cell size (Single or Double) based on weekly volume thresholds.
	•	Store-level rank based on script demand.

Automation Type Ranking Limits:
	•	SP200 → Top 190 NDCs
	•	Parata Max → Top 190 NDCs
	•	SP100 → Top 95 NDCs
	•	CRS → Top 125 NDCs

⸻

Output and Usage

The final results identify store-specific NDCs best suited for automation, balancing script frequency, packaging efficiency, and device capacity.
Outputs can be integrated into Tableau or Power BI dashboards to visualize:
	•	Automation volume by week and region.
	•	NDC recommendation lists by store and device type.
	•	Unit-of-use optimization rates and automation efficiency.

⸻

Summary

Together, AutomationScriptVolume.sql and Recommended NDC Lists.sql deliver a comprehensive framework to:
	•	Quantify automation activity at the store and product level.
	•	Recommend optimal NDCs for automation based on usage and efficiency.
	•	Improve pharmacy workflow through data-driven optimization of automation inventory.

These scripts enable better automation management and operational insights across retail pharmacy networks.

⸻
