
Here’s a clean, professional README.md file written in your preferred paragraph-style format — consistent with the structure used in your previous project documentation:

⸻

Central Fill Workforce Productivity Analysis

This SQL script analyzes Central Fill (CF) pharmacy workforce activity over a 60-day period to evaluate hourly productivity and operational efficiency. It captures detailed event-level data for CF associates, linking each prescription fill activity to the responsible employee, time of action, and Central Fill facility. The resulting dataset supports insights into average hourly script volumes, working hours, and staffing performance across CF locations.

⸻

Overview

The purpose of this query is to quantify and monitor Central Fill employee performance by analyzing workflow activities tied to prescription fills. The script identifies CF employees who performed key actions such as script preparation, verification, and completion, then aggregates their activity counts at hourly and daily levels. It helps operational teams identify productivity trends, peak workload periods, and staffing optimization opportunities.

⸻

Workflow Logic

1. CF_DATA (Activity Capture and Enrichment)

This section extracts detailed prescription activity data from multiple curated sources:
	•	CORE_RX.CURATED_SCRIPT.PRESCRIPTION_FILL_ACTIVITY for event timestamps and user-level activity codes.
	•	CORE_RX.CURATED_SCRIPT.CENTRAL_FILL_RX_ASSIGNMENT to map prescriptions to the respective CF facility.
	•	CORE_RX.CURATED_SCRIPT.PRESCRIPTION_FILL_XREF for store and fill identifiers.
	•	CORE_RX.CURATED_SENSITIVE.EMPLOYEE to enrich data with employee names and job titles.

The query filters for recent activity within the last 60 days, focusing on key CF workflow stages represented by Activity Codes (3, 74, 75) — typically indicating script processing, verification, or preparation actions.

Each record includes:
	•	Employee details: First Name, Last Name, Job Title.
	•	CF facility identifiers: Store Number, Facility ID.
	•	Activity timestamps: Effective Timestamp, Effective Date.
	•	Time-bucket labels:
	•	hour_label (e.g., 13:00–14:00) for hourly aggregation.
	•	EFFECTIVE_TS_quarter_label to classify events into 15-minute intervals.

This temporal grouping enables flexible aggregation for performance analysis by hour or shift.

⸻

2. TEMP (Intermediate Aggregation by Employee and Time Window)

This section aggregates prescription activity at the employee–hour level to calculate the number of unique scripts handled per 15-minute and hourly interval.

It joins the activity data with CORE_FSSC.CURATED_CALENDAR.DAY to map each activity to its fiscal week number (FISCAL_WEEK_NBR), ensuring alignment with CVS Health’s reporting calendar.

For each employee and date, it computes:
	•	SCRIPT_CNT: Number of unique prescriptions processed.
	•	QUATER_CNT: Number of active 15-minute time windows worked.
	•	FISCAL_WEEK_NBR: For temporal grouping in weekly productivity reporting.

⸻

3. Final Aggregation and Metrics Computation

The final section calculates key performance metrics by Central Fill facility and employee:
	•	TOTAL_SCRIPTS: Sum of all scripts handled per day.
	•	AVG_HOURLY_VOL: Average hourly volume computed as SCRIPT_CNT / QUATER_CNT.
	•	HOURS_WORKED: Derived by dividing total 15-minute intervals by 4, rounded to one decimal place.

The dataset includes only records where more than two scripts were processed per day to exclude low-activity outliers. Results are sorted by facility, date, and hourly volume in descending order to highlight top-performing employees and shifts.

⸻

Output and Insights

The resulting dataset provides a detailed view of employee-level productivity across Central Fill operations, including:
	•	Daily and weekly script volumes processed by each employee.
	•	Average hourly throughput and hours worked.
	•	Comparative performance across CF facilities, regions, and roles.

This analysis enables leadership teams to:
	•	Identify top-performing employees and peak workload hours.
	•	Evaluate labor utilization efficiency within each CF site.
	•	Support resource allocation, scheduling, and process improvement initiatives based on real workload patterns.

⸻

Summary

The Central Fill Workforce Productivity Analysis query consolidates CF prescription activity data with employee and calendar details to generate actionable insights into operational performance. By quantifying hourly volumes and work durations, this dataset supports performance benchmarking, workforce planning, and continuous improvement efforts across Central Fill facilities.

⸻
